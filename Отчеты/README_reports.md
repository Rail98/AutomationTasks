Логика. 

У нас три файла: python-скрипт, sql-запрос, excel-шаблон. 
Основная процедура происходит в python-скрипте (.py). Здесь происходит сборка, обработка и выгрузка данных.
Отдельно вынесен sql-запрос, чтобы была возможность менять его напрямую. Если нужно добавить новое условие в запрос, то открывать python-скрипт не потребуется.
Excel-шаблон служит для построения шапки отчета, в котором удобно указать название столбцов, ключевые слова (название отчета, имена сотрудников и т.д.), и применить дополнительные действия (например, поменять шрифт, сделать заливку с использование условного форматирования).
Автоматически выполнять код будет Планировщик заданий от Windows. Эта программа по умолчания установлена в ОС Winodws. С помощью него мы можем настраивать время запуска отчета, его частоту и продолжительность.
